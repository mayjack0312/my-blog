# 浅谈DDoS攻击和机场防御

## 目录

- [浅谈DDoS攻击和机场防御](#浅谈ddos攻击和机场防御)
  - [目录](#目录)
  - [前言](#前言)
    - [DDoS攻击的含义](#ddos攻击的含义)
    - [聊聊DDoS的概念和发展](#聊聊ddos的概念和发展)
    - [何为“拒绝服务”攻击？](#何为拒绝服务攻击)
    - [何为“分布式”？](#何为分布式)
    - [何为“僵尸网络”？](#何为僵尸网络)
    - [DDoS的发展怎么样？](#ddos的发展怎么样)
    - [DDoS攻击的工作原理是什么？](#ddos攻击的工作原理是什么)
    - [谈谈DDoS的攻击方式](#谈谈ddos的攻击方式)
    - [其主要攻击方法有4种：](#其主要攻击方法有4种)
      - [1. 攻击带宽](#1-攻击带宽)
      - [2. 攻击系统](#2-攻击系统)
      - [3.攻击应用](#3攻击应用)
      - [4.混合攻击](#4混合攻击)
    - [DDoS攻击的分类](#ddos攻击的分类)
    - [DDoS攻击中涉及的OSI模型中的七个网络连接层](#ddos攻击中涉及的osi模型中的七个网络连接层)
    - [容积攻击](#容积攻击)
        - [常见的容积攻击类型](#常见的容积攻击类型)
          - [UDP泛洪攻击](#udp泛洪攻击)
          - [DNS反射/放大](#dns反射放大)
          - [ICMP泛洪攻击](#icmp泛洪攻击)
    - [协议攻击](#协议攻击)
        - [SYN泛洪攻击](#syn泛洪攻击)
        - [Smurf DDoS攻击](#smurf-ddos攻击)
      - [应用层攻击](#应用层攻击)
        - [例：HTTP泛洪攻击](#例http泛洪攻击)
    - [L4攻击](#l4攻击)
    - [L7攻击](#l7攻击)
    - [CC攻击](#cc攻击)
    - [挑选攻击对象](#挑选攻击对象)
    - [DDoS攻击的目的是什么？](#ddos攻击的目的是什么)
    - [DDoS的攻击工具](#ddos的攻击工具)
      - [1. LOIC](#1-loic)
      - [2. HULK (HTTP Unbearable Load King)](#2-hulk-http-unbearable-load-king)
      - [3. R.U.D.Y.](#3-rudy)
    - [处理方式](#处理方式)
    - [预防攻击方法](#预防攻击方法)
    - [如何阻止DDoS攻击？](#如何阻止ddos攻击)

## 前言

随着国内网络环境的恶化，以及防火墙的封锁力度加大，越来越多的用户翻墙开始变得逐渐困难。而在这段时间内，涌现了一大批中小机场，TG机场圈被分为了开业时间长，服务稳定的“大机场”以及开业时间较短，服务稳定性相对较低的“中小机场”，这些机场凭借高性价比吸引了大批客户，但同时，也吸引了另一批想要非法牟利的群体——DDoS攻击者。

### DDoS攻击的含义

在分布式拒绝服务(DDoS)攻击中，攻击者发出海量实际上并不需要的互联网流量，耗尽其目标的资源，造成正常流量无法到达其预定目的地。
但是这到底意味着什么呢？不妨设想一下您喜爱的僵尸片。成群结队的受感染生物有着相同的目标-传播“僵尸瘟疫”，摧毁文明世界。它们让执法机构的资源不堪重负，耗尽了军事力量，并破坏了医疗服务。然后人们为了逃生而涌向高速公路，造成不可避免的严重交通堵塞。DDoS攻击也是如此：网络世界里的“僵尸启示录”。只不过威胁并非僵尸，而是大量受到感染的电脑，它们同时攻击目标网站，将人类和企业赶走。
针对一家公司的网站、Web应用程序、API、网络或数据中心基础架构的发起的DDoS攻击会造成停机，导致合法用户无法购买产品、使用服务、获取信息或者进行其他正常访问。
在DDoS攻击中，攻击者利用大量遭遇入侵的机器和接入互联网的设备，包括物联网(IoT)设备、智能手机、个人电脑和网络服务器，向目标发送大量流量。

### 聊聊DDoS的概念和发展

在讲发展前，我们先对分布式拒绝服务（DDoS）的基本概念有个大体了解。

### 何为“拒绝服务”攻击？

其实可以简单理解为：让一个公开网站无法访问。要实现这个目的，方法也很简单：不断地提出服务请求，让合法用户的请求无法及时处理。

### 何为“分布式”？

随着网络发展，很多大型企业具备较强的服务提供能力，所以应付单个请求的攻击已经不是问题。“道高一尺，魔高一丈”，攻击者就组织很多同伙，同时提出服务请求，直到服务无法访问，这就叫“分布式”。但是，在现实中，一般的攻击者无法组织各地伙伴协同“作战”，所以会使用“僵尸网络”来控制N多计算机进行攻击。

### 何为“僵尸网络”？

就是数量庞大的僵尸程序（Bot）通过一定方式组合，出于恶意目的，采用一对多的方式进行控制的大型网络，也可以说是一种复合性攻击方式。因为僵尸主机的数量很大而且分布广泛，所以危害程度和防御难度都很大。
僵尸网络具备高可控性，控制者可以在发布指令后，就断开与僵尸网络的连接，而控制指令会自动在僵尸程序间传播执行。

<div align=center><img src="https://github.com/mayjack0312/image/blob/main/6be4a821627408df56db22cf0a56fcf4_ececa29f98fa3e91d3fbd781f391a23b.jpg"></div>

这就像个生态系统一样。对安全研究人员来说，通过捕获一个节点虽然可以发现此僵尸网络的许多僵尸主机，但很难窥其全貌，而且即便封杀一些僵尸主机，也不会影响整个僵尸网络的生存。

### DDoS的发展怎么样？

正所谓“以史为鉴，可以知兴替”。既然大概了解了DDoS，咱们说说它的历史发展。最早的时候，黑客们大都是为了炫耀个人技能，所以攻击目标选择都很随意，娱乐性比较强。后来，有一些宗教组织和商业组织发现了这个攻击效果，就以勒索、报复等方式为目的，对特定目标进行攻击，并开发一些相应的工具，保证攻击成本降低。当国家级政治势力意识到这个价值的时候，DDoS就开始被武器化，很容易就被用于精确目标的网络战争中。

<div align=center><img src="https://github.com/mayjack0312/image/blob/main/image18.png"></div>

- 根据CF 2021年第四季度的DDoS态势分析，从全球流量分布来看，中国和美国是DDoS受灾的重灾区。

### DDoS攻击的工作原理是什么？

DDoS攻击利用接入互联网上的设备构成的彼此连接的网络，切断用户与服务器或网络资源（比如用户经常访问的网站或者应用程序）的联系。
为了发动DDoS攻击，攻击者会使用恶意软件或利用安全漏洞，恶意感染机器和设备，并获得其控制权。每台电脑或者受到感染的设备都称之为“爬虫程序”或“僵尸”，它们能够进一步传播恶意软件并参与DDoS攻击。这些爬虫程序共同构成了称为“僵尸网络”的僵尸军团，利用数量优势扩大攻击规模。此外，人们往往不会注意到物联网设备受感染，这很像是僵尸恐怖片里经常会有的那只麻烦的僵尸，主角们根本不知道它已经被感染了，而在物联网设备中，这会造成合法的设备所有者成为次要受害者或不知情的参与者，而受害企业仍然难以分辨攻击者的身份。
在攻击者成功建立起僵尸网络之后，就可以远程对每个爬虫程序发号施令，
发起对于目标系统的DDoS攻击。在僵尸网络攻击某个网络或服务器时，攻击者会指示僵尸向受害者的IP地址发送请求。我们每个人都有独一无二的指纹，而设备也有类似的特征，每台设备都有一个唯一的地址，可以用来在互联网或本地网络上识别它们。流量过大造成拒绝服务，使正常流量无法访问网站、Web应用、API或网络。
有时，僵尸网络及其中的爬虫程序会通过“雇佣攻击”服务的形式出租给其他有意发起攻击的人。这让那些没有接受过训练、缺乏经验的恶意攻击者也能轻松自行发动DDoS攻击。

### 谈谈DDoS的攻击方式

分布式拒绝服务攻击的精髓是：利用分布式的客户端，向目标发起大量看上去合法的请求，消耗或者占用大量资源，从而达到拒绝服务的目的。

### 其主要攻击方法有4种：

#### 1. 攻击带宽

    跟交通堵塞情况一样，大家都应该清楚：当网络数据包的数量达到或者超过上限时，会出现网络拥堵、响应缓慢的情况。DDoS就是利用这个原理，发送大量网络数据包，占满被攻击目标的全部带宽，从而造成正常请求失效，达到拒绝服务的目的。
    攻击者可以使用ICMP洪水攻击（即发送大量ICMP相关报文）、或者UDP洪水攻击（即发送用户数据报协议的大包或小包），使用伪造源IP地址方式进行隐匿，并对网络造成拥堵和服务器响应速度变慢等影响。
    但是，这种直接方式通常依靠受控主机本身的网络性能，所以效果不是很好，还容易被查到攻击源头。于是反射攻击就出现，攻击者使用特殊的数据包，即IP地址指向作为反射器的服务器，源IP地址被伪造成攻击目标的IP，反射器接收到数据包的时候就被骗了，会将响应数据发送给被攻击目标，然后就会耗尽目标网络的带宽资源。

#### 2. 攻击系统

    创建TCP连接需要客户端与服务器进行三次交互，也就是常说的“三次握手”。这个信息通常被保存在连接表结构中，但是表的大小有限，所以当超过存储量，服务器就无法创建新的TCP连接。
    攻击者利用这一点，用受控主机建立大量恶意的TCP连接，占满被攻击目标的连接表，使其无法接受新的TCP连接请求。如果攻击者发送了大量的TCP SYN报文，让服务器在短时间内产生大量的半开连接，连接表也会被很快占满，导致无法建立新的TCP连接，这个方式是SYN洪水攻击，很多攻击者都比较常用。


<div align=center><img src="https://github.com/mayjack0312/image/blob/main/83f268b19c1caa273f82e67c9a8d13d.jpg"></div>

#### 3.攻击应用

    由于DNS和Web服务的广泛性和重要性，这两种服务就成为消耗应用资源的分布式拒绝服务攻击的主要目标。
    比如，向DNS服务器发送大量查询请求，从而达到拒绝服务的效果，如果每一个DNS解析请求所查询的域名都是不同的，那么就有效避开服务器缓存的解析记录，达到更好的资源消耗效果。当DNS服务的可用性受到威胁，互联网上大量的设备都会受到影响而无法正常使用。
    近些年，Web技术发展非常迅速，如果攻击者利用大量的受控主机不断地向Web服务器恶意发送大量HTTP请求，要求Web服务器处理，就会完全占用服务器资源，让正常用户的Web访问请求得不到处理，导致拒绝服务。一旦Web服务受到这种攻击，就会对其承载的业务造成致命的影响。

#### 4.混合攻击

    在实际的生活中，攻击者并不关心使用的哪种攻击方法管用，只要能够达到目的，一般就会发动其所有的攻击手段，尽其所能的展开攻势。对于被攻击目标来说，需要面对不同的协议、不同资源的分布式拒绝服务攻击，分析、响应和处理的成本就会大大增加。
    随着僵尸网络向小型化的趋势发展，为降低攻击成本，有效隐藏攻击源，躲避安全设备，同时保证攻击效果，针对应用层的小流量慢速攻击已经逐步发展壮大起来。因此，从另一个角度来说，DDoS攻击方面目前主要是两个方面：一是UDP及反射式大流量高速攻击，二是多协议小流量及慢速攻击。

### DDoS攻击的分类

DDoS攻击分为许多不同类型，攻击者经常混合使用多种攻击来给目标造成严重破坏。其中三种关键类型是容积攻击、协议攻击和应用层攻击。所有攻击的目的都是为了严重拖慢合法流量的速度，或者阻止合法流量到达其预定目的地。例如，这可能意味着用户无法正常访问网站、购买产品或服务、观看视频，或者无法在社交媒体上进行互动。此外，DDoS会造成资源不可用或性能下降，导致业务陷入停滞。它可能导致员工无法访问电子邮件、Web应用，或让他们无法照常处理工作。
为了进一步探究DDoS攻击的工作原理，我们来具体分析一下攻击者可能采取的不同攻击途径。开放系统互连模型也叫做“OSI模型”，它是各种网络标准的分层式框架，包含七个不同层次。OSI模型的每一层都有独特的用途，就像一栋办公楼中每个楼层都有不同的业务功能。攻击者根据他们想要破坏的网络或面向互联网的资产类型，针对不同的层次发起攻击。
**DDoS攻击主要分为了L4攻击和L7攻击（HTTP DDOS）**

<div align=center><img src="https://github.com/mayjack0312/image/blob/main/OSI%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B.png"></div>

- L4即传输层，L7即应用层

### DDoS攻击中涉及的OSI模型中的七个网络连接层

    第7层 - 应用层
    应用层位于OSI模型的顶端，最靠近最终用户。它是人与电脑和设备对接的位置，也是网络与应用程序连接的地方。

    第6层 - 表示层
    数据加密和解密都在表示层中发生，从而实现安全传输。

    第5层 - 会话层
    会话层允许设备、电脑或服务器彼此通信，并控制端口和会话。

    第4层 - 传输层
    在传输层，数据通过传输控制协议(TCP)进行通信，该协议基于互联网协议(IP)，也称为TCP/IP。

    第3层 - 网络层
    网络层决定了数据到达目的地的物理路径。

    第2层 - 数据链路层
    数据链路层提供了一种在网络实体之间传输数据的方式。它也用来检测和纠正物理层可能发生的错误。

    第1层 - 物理层
    第1层叫做物理层，也是最低的一层，在这里，原始比特位通过连接各个网络节点的物理数据链路传输。

### 容积攻击

容积型DDoS攻击的目的是用海量流量充塞网络，耗尽预期受害方资源的带宽。海量攻击流量阻断了合法用户对应用程序或服务的访问，造成流量无法正常流入或流出。根据目标的不同，阻止合法流量可能意味着银行客户无法按时支付账单、电商购物者无法完成在线交易、医院患者无法查看其病历，公民无法查看自己在政府机构处的纳税记录。无论受到攻击的是什么企业，只要人们无法使用他们期望通过网络使用的服务，就会产生负面影响。
容积攻击使用的攻击途径是由一种恶意软件感染的众多系统和设备组成的僵尸网络。在攻击者的控制下，爬虫程序发出恶意流量，耗尽所有可用带宽，造成攻击目标与互联网之间的连接拥塞。
不可预见的僵尸流量造成的冲击可能大大减慢或阻止对于Web资源或面向互联网的服务的访问。由于爬虫程序会取代合法设备，以放大带宽密集型DDoS攻击，但用户往往毫不知情，因此受害企业很难发现恶意流量。

##### 常见的容积攻击类型

###### UDP泛洪攻击

    UDP泛洪攻击经常被选择用于带宽较大的DDoS攻击。攻击者会试图用包含无状态UDP协议的IP数据包充塞目标主机上的端口。随后，受害主机寻找与UDP数据包相关的应用程序，如果没有找到，就向发送者回发一条“目标不可达”消息。攻击者经常通过冒用IP地址来隐藏自己的身份，一旦目标主机被攻击流量淹没，系统就会失去响应，造成合法用户无法正常使用。

###### DNS反射/放大

    DNS反射攻击是一种常见的攻击媒介，网络犯罪分子通过伪装其目标的IP地址，向开放的DNS服务器发送大量请求。作为回应，这些DNS服务器通过伪造的IP地址响应恶意请求，大量的DNS答复形成洪流，从而构成预定目标的攻击。很快，通过DNS答复产生的大量流量就会造成受害企业的服务不堪重负、无法使用，并造成合法流量无法到达其预定目的地。

###### ICMP泛洪攻击

    互联网控制消息协议(ICMP)主要用于错误信息传递，通常不会在系统之间交换数据。ICMP数据包可能与传输控制协议TCP数据包一同传输，让应用程序和计算设备在连接到服务器时可以通过网络交换信息。ICMP泛洪攻击是一种第3层基础架构DDoS攻击方法，它使用ICMP消息来造成目标网络带宽超载。

### 协议攻击

协议攻击通过尝试利用协议通信的恶意连接请求来消耗并耗尽各种网络基础架构资源（如服务器或防火墙）的计算容量。同步(SYN)泛洪攻击和Smurf DDoS是基于协议的DDoS攻击的两种常见类型。协议攻击可以用每秒数据包数量(pps)和每秒比特数(bps)来衡量。

##### SYN泛洪攻击

    人们连接到互联网应用的主要方式之一是通过传输控制协议(TCP)。这种连接需要从TCP服务（如Web服务器）进行三方握手，涉及到从用户连接到服务器的位置发送所谓的SYN（同步）数据包，然后服务器返回一个SYN-ACK（同步确认）数据包，最终通过最后的ACK（确认）通信作为应答，以此完成TCP握手。
    在SYN泛洪攻击中，恶意客户端发送大量SYN数据包（通常在握手的第一部分），但永远不会发送确认以完成握手。这使得服务器一直等待对于这些半开放的TCP连接的响应，而这些连接最终会耗尽容量，造成服务器无法接受跟踪连接状态的新连接。
    SYN泛洪攻击就好像一所大型高中里，整个毕业班的一场可怕恶作剧-所有学生在同一时间段内打电话给同一家披萨店，每个人都要订个披萨。在送餐员备货时，她会发现收到了太多的披萨订单，外卖车根本装不下，而且订单上也没有地址，所以所有送餐都会停止。

##### Smurf DDoS攻击

    这种DDoS攻击的名称来源是：众多规模较小的攻击者可以凭借纯粹的数量优势来压倒更大规模的对手，就像幻想故事里的蓝精灵(Smurf)一样。
    在Smurf分布式拒绝服务攻击中，攻击者使用某个IP广播地址，向计算机网络广播大量带有目标仿冒源IP的互联网控制消息协议(ICMP)数据包。默认情况下，网络上的大多数设备将通过向该源IP地址发送回复的方式来做出响应。根据网络上机器数量的不同，受害计算机的速度可能会因为流量泛洪而被严重拖慢。

#### 应用层攻击

##### 例：HTTP泛洪攻击

    应用层攻击是通过向应用程序发送大量恶意请求实现的，以每秒请求数(RPS)来衡量。这类攻击也称为第7层DDoS攻击，针对并破坏特定的网络应用程序，而不是整个网络。虽然这类DDoS攻击难以预防和抵御，但发动起来却相对比较容易。
    打个比方来说，惊吓一群马并让它们到处乱跑容易，但要再次将它们控制起来几乎很难实现。应用层攻击就是这样：容易实施，但难以减缓或阻止，而且特定于某个目标。

### L4攻击

    L4攻击是针对直接是网络传输层，通过软件根本无法防御，只能依靠机房的被动防御，解决方法也很简单，加钱即可，否则只能关机保平安。
    对于l4,可以尝试使用类似Argo Tunnel的类似服务,通过argo传输所有数据,服务器可以关闭包括22&80在内的所有端口,并且这样做可以避免遭到源站扫描,通过配置cloudflare规则,可以做到任何事情，不过并不清楚后端和面板的通信方法,这样做可能会导致无法通信,不过依旧可以防止除通讯端口外的扫描与爆破。
因此下文主要讨论L7攻击的防御方法。

### L7攻击

    L7攻击，又名“HTTP DDOS”，国人一般称其为“CC攻击”，此种方法攻击成本较低，成效快，因此被多数攻击者所选择，下文将称为“CC攻击”。

### CC攻击

    攻击者进行CC攻击的目的一般是获取赎金，这不禁让我想起了之前TG盛传的一种诈骗广告，假借“教授DDoS攻击非法网站，获取赎金”为名，引导用户购买自己搭建的所谓“荷兰风车伪造VPS”。我相信，肯定是有部分攻击者从这个广告中得到启发的。

### 挑选攻击对象

攻击者一般会对攻击对象进行挑选
对于大机场来说，一般具有完备的防攻击的手段和处理流程，除非拥有大量ddos资源，否则谁会去无聊到攻击大机场。
对于小机场呢，不具备勒索条件（毕竟本身营业额就低，被打了怎么办？跑路呗）
所以目标就只剩下了中小机场，攻击者打击的方式也很简单，一般是直接攻击机场官网，假如在前后端不分离的情况下，一旦机场面板服务器被攻击，用户也无法正常更新订阅链接。假如前后端分离，攻击者则会攻击面板+订阅链接，会造成同上的局面，造成机场瘫痪。

### DDoS攻击的目的是什么？

分布式拒绝服务攻击(DDoS)试图通过多个来源的恶意流量造成在线服务、网站和网络应用程序不堪重负，或者耗尽目标资产的计算资源并且使之因此而陷入瘫痪。攻击者的目标是让合法用户无法正常使用该目标，它的目的只有一个——就是破坏。DDoS攻击的目标是人们日常生活中依赖的各种资源，包括金融服务、医疗信息、新闻机构、教育系统和网络购物。
在发起旨在给企业造成破坏的DDoS攻击时，攻击者的动机不一而足。常见的动机可能包括：
- 出于政治或社会原因而进行黑客攻击
- 民族国家攻击者试图造成经济或社会混乱
- 造成竞争对手的服务或产品不可用，并尝试借机招揽业务
- 将DDoS攻击用作“烟幕”，转移紧急事件响应小组对更不易察觉的复杂攻击的注意力
- 通过敲诈勒索来谋取经济利益

近来，DDoS敲诈攻击已成为网络犯罪分子间一个极为常见的动机。DDoS敲诈攻击也叫做DDoS勒索(RDDoS)攻击，在此类攻击中，威胁攻击者团体（比如Copycats等）用DDoS事件威胁企业，要求企业支付赎金或满足敲诈勒索最后通牒中的要求，否则就会发动DDoS攻击。通常情况下，这些犯罪份子会先给一个下马威，证明他们有能力造成破坏，并提高成为攻击目标的公司支付赎金的可能性。为了避免被抓，攻击者往往坚持要求被勒索者通过比特币等加密货币付款。
DDoS勒索攻击的目的就是索要赎金，就好像小学生被霸凌者偷走了作业，霸凌者要求小学生交出午餐钱来换回作业一样。在复杂的网络霸凌世界中，赎金采用数字化形式，无法追踪。

### DDoS的攻击工具

#### 1. LOIC

    LOIC是一个颇受欢迎的DOS攻击的淹没式工具，会产生大量流量，可以在多种平台运行，包括Linux、Windows、Mac OS、Android等。早在2010年，黑客组织对反对维基解密的公司和机构的攻击活动中，该工具被下载了3万次以上。
    LOIC界面友好，易于使用，初学者也可以很快上手。但是由于该工具需要使用真实IP地址，现在已经停用。

#### 2. HULK (HTTP Unbearable Load King)

    HULK是另一个DOS攻击工具，这个工具使用UserAgent的伪造，来避免攻击检测，可以通过启动500线程对目标发起高频率HTTP GET FLOOD请求，更可怕的是每一次请求都是独立的，可以绕过服务端的缓存措施，让所有请求得到处理。HULK是用Python语言编写，对获得的源码进行更改也非常方便。

#### 3. R.U.D.Y.

    R-U-Dead-Yet是一款采用慢速HTTP POST请求方式进行DOS攻击的工具，它提供了一个交互式控制台菜单，检测给定的URL，并允许用户选择哪些表格和字段应用于POST-based DOS攻击，操作非常简单。
    而且，它也使用的是Python语言编写，可移植性非常好。R.U.D.Y.能够对所有类型的Web服务端软件造成影响，因此攻击的威胁非常大。这些工具在保持攻击力的同时还再加强易用性，而免费和开源降低了使用门槛。随着攻防对抗的升级，工具会越来越智能化。

### 处理方式

首先当然是要向客户说明情况，不然以为你跑路了hh`(*^▽^*)`
攻击者在攻击后肯定会主动联系，索要赎金。此时，一定不要接受他的报价，因为你一旦接受，他只会变本加厉，你反倒助长了他的嚣张气焰。
及时更换网站服务器（不至于用1c512M建站吧。。），同时做好相关的防御手段：如套cdn等等。

### 预防攻击方法

```
带宽得保证(怎么着也得上主干1000了吧)
DDoS防护
面板机尽量挑选高防，防L4攻击的那种
基于CDN的防御
如果你不是对你的面板机很有自信的话，建议套个cdn（CF为佳）
在面板的关键操作处（如注册，登录）可以加上一层验证码，因为我曾经见过一种不同寻常的攻击方式，就是批量注册，用垃圾数据塞爆数据库。
不要忘记升级
DDoS云端净化
异常流量的清洗
优先考虑静态
分布式集群防御
边缘无效化CDN
集群负载均衡加机器
L4无效化L7检测到异常流量后直接在L4封IP（nginx发现连接数异常直接在L4选择性拉闸）
对于api等的l7攻击,在除了完善规则外,rate limit也不妨是一个好的选择,手动获取cf waf logs(并不是获取nginx),统计超过次数的ip,封禁单位时间
```

### 如何阻止DDoS攻击？

在抵御过程中，您的DDoS保护提供商将部署一系列的应对措施，以阻止分布式拒绝服务(DDoS)攻击并降低其影响。随着现代攻击变得越来越先进，基于云的DDoS抵御保护措施有助于通过大规模深度防御保障安全，保持后端基础架构和面向互联网的服务的可用性和出色性能。
通过DDoS攻击防护服务，可以：
```
减小与DDoS攻击有关的攻击面和业务风险
防止影响业务的停机时间
提高对DDoS事件的响应速度，优化事件响应资源
缩短了解和调查服务中断的时间
防止员工生产力损失
更迅速地部署应对措施，以抵御DDoS攻击
防止品牌声誉和利益遭受损失
保护整个数字资产环境，保持应用程序正常运行时间和性能
最大程度地降低与Web安全相关的成本
抵御新型及不断发展变化的威胁
```
